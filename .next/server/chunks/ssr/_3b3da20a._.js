module.exports=[89531,a=>{"use strict";var b=a.i(87924),c=a.i(60721),d=a.i(50944),e=a.i(72131);function f({children:a,requiredRole:f}){let{user:g,isLoading:h,hasRole:i}=(0,c.useAuth)(),j=(0,d.useRouter)();return((0,e.useEffect)(()=>{if(!h){if(!g)return void j.push("/auth");if(f&&!i(f))return void j.push("/")}},[g,h,f,i,j]),h)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):g?f&&!i(f)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,b.jsx)("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):(0,b.jsx)(b.Fragment,{children:a}):null}a.s(["ProtectedRoute",()=>f])},62573,a=>{"use strict";let b="sharporder_db";function c(){let a=localStorage.getItem(b);return a?JSON.parse(a):{orders:{},stores:{},blockedConsumers:[]}}function d(a){localStorage.setItem(b,JSON.stringify(a))}let e={create:a=>{let b=c(),e={...a,id:`order_${Date.now()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return b.orders[e.id]=e,d(b),e},getById:a=>c().orders[a]||null,getByConsumer:a=>Object.values(c().orders).filter(b=>b.consumerId===a),getByStore:a=>Object.values(c().orders).filter(b=>b.storeId===a),getAll:()=>Object.values(c().orders),update:(a,b)=>{let e=c(),f=e.orders[a];if(!f)throw Error("Order not found");let g={...f,...b,updatedAt:new Date().toISOString()};return e.orders[a]=g,d(e),g},delete:a=>{let b=c();delete b.orders[a],d(b)}},f={create:a=>{let b=c(),e={...a,id:`store_${Date.now()}`,createdAt:new Date().toISOString()};return b.stores[e.id]=e,d(b),e},getById:a=>c().stores[a]||null,getByAdmin:a=>Object.values(c().stores).find(b=>b.adminId===a)||null,getAll:()=>Object.values(c().stores),update:(a,b)=>{let e=c(),f=e.stores[a];if(!f)throw Error("Store not found");let g={...f,...b};return e.stores[a]=g,d(e),g},delete:a=>{let b=c();delete b.stores[a],d(b)}},g={add:a=>{let b=c();b.blockedConsumers.includes(a)||(b.blockedConsumers.push(a),d(b))},remove:a=>{let b=c();b.blockedConsumers=b.blockedConsumers.filter(b=>b!==a),d(b)},isBlocked:a=>c().blockedConsumers.includes(a),getAll:()=>c().blockedConsumers};a.s(["AnalyticsDB",0,{getStoreAnalytics:a=>{let b=e.getByStore(a),c=b.reduce((a,b)=>a+(b.totalPrice-b.discount),0);return{totalOrders:b.length,totalRevenue:c,averageOrderValue:b.length>0?c/b.length:0,recentOrders:b.slice(-10)}},getSystemAnalytics:()=>{let a=e.getAll(),b=f.getAll(),c=g.getAll().length,d=a.reduce((a,b)=>a+(b.totalPrice-b.discount),0),h=new Set(a.map(a=>a.consumerId)).size;return{totalOrders:a.length,totalRevenue:d,averageOrderValue:a.length>0?d/a.length:0,recentOrders:a.slice(-20),totalStores:b.length,totalConsumers:h,totalBlocked:c}}},"BlockedConsumerDB",0,g,"OrderDB",0,e,"StoreDB",0,f])},83497,a=>{"use strict";let b=(0,a.i(70106).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],83497)},81560,a=>{"use strict";let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],81560)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},631,a=>{"use strict";var b=a.i(87924),c=a.i(60721),d=a.i(62573),e=a.i(89531),f=a.i(83497),g=a.i(81560);let h=(0,a.i(70106).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var i=a.i(15618),j=a.i(72131);function k(){let{user:a}=(0,c.useAuth)(),[k,l]=(0,j.useState)([]),[m,n]=(0,j.useState)(null),[o,p]=(0,j.useState)(!1),[q,r]=(0,j.useState)(null),[s,t]=(0,j.useState)(!0),[u,v]=(0,j.useState)({name:"",price:"",description:"",category:"",stock:""}),[w,x]=(0,j.useState)(""),[y,z]=(0,j.useState)("");(0,j.useEffect)(()=>{a&&a.storeId&&(n(d.StoreDB.getById(a.storeId)),fetch(`/api/products?storeId=${encodeURIComponent(a.storeId)}`).then(a=>a.json()).then(a=>{l(a||[])}).catch(()=>l([])).finally(()=>t(!1)))},[a]);let A=a=>{let{name:b,value:c}=a.target;v(a=>({...a,[b]:c})),x("")};return(0,b.jsx)(e.ProtectedRoute,{requiredRole:"admin",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Product Management"}),(0,b.jsxs)("button",{onClick:()=>{p(!o),r(null),v({name:"",price:"",description:"",category:"",stock:""})},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[(0,b.jsx)(i.Plus,{size:18}),"Add Product"]})]}),w&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm",children:w}),y&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm",children:y}),s?(0,b.jsx)("div",{className:"text-center py-12",children:"Loading products..."}):(0,b.jsxs)(b.Fragment,{children:[o&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6 mb-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:q?"Edit Product":"Add New Product"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),(0,b.jsx)("input",{type:"text",name:"name",value:u.name,onChange:A,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),(0,b.jsx)("input",{type:"number",name:"price",value:u.price,onChange:A,step:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,b.jsxs)("select",{name:"category",value:u.category,onChange:A,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select Category"}),(0,b.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,b.jsx)("option",{value:"Clothing",children:"Clothing"}),(0,b.jsx)("option",{value:"Books",children:"Books"}),(0,b.jsx)("option",{value:"Food",children:"Food"}),(0,b.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock"}),(0,b.jsx)("input",{type:"number",name:"stock",value:u.stock,onChange:A,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)("textarea",{name:"description",value:u.description,onChange:A,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,b.jsx)("button",{onClick:()=>{if(x(""),!u.name||!u.price||!u.category||!u.stock)return void x("All fields are required");let b={id:q||`prod_${Date.now()}`,name:u.name,price:parseFloat(u.price),description:u.description,category:u.category,stock:parseInt(u.stock),storeId:a?.storeId};fetch("/api/products",{method:q?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product:b})}).then(a=>a.json()).then(b=>{if(b&&b.id){if(q?(l(k.map(a=>a.id===q?{...b,id:q}:a)),z("Product updated successfully"),r(null)):(l([...k,b]),z("Product added successfully")),a&&a.storeId){let c={...m,products:q?k.map(a=>a.id===q?{...b,id:q}:a):[...k,b]};d.StoreDB.update(a.storeId,c),n(c)}v({name:"",price:"",description:"",category:"",stock:""}),p(!1),setTimeout(()=>z(""),3e3)}else x("Failed to save product")}).catch(()=>x("Failed to save product"))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:q?"Update Product":"Add Product"}),(0,b.jsx)("button",{onClick:()=>{p(!1),r(null),v({name:"",price:"",description:"",category:"",stock:""})},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 font-medium",children:"Cancel"})]})]}),0===k.length?(0,b.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-gray-200",children:[(0,b.jsx)(f.Package,{size:48,className:"mx-auto text-gray-300 mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:'No products yet. Click "Add Product" to get started.'})]}):(0,b.jsx)("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Product Name"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Category"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Price"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Stock"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:k.map(c=>(0,b.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"py-3 px-4 font-semibold text-gray-900",children:c.name}),(0,b.jsx)("td",{className:"py-3 px-4 text-gray-600",children:c.category}),(0,b.jsxs)("td",{className:"py-3 px-4 text-gray-900 font-semibold",children:["$",c.price.toFixed(2)]}),(0,b.jsx)("td",{className:"py-3 px-4 text-gray-600",children:(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-semibold ${c.stock>10?"bg-green-100 text-green-800":c.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:c.stock})}),(0,b.jsx)("td",{className:"py-3 px-4 text-center",children:(0,b.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{v({name:c.name,price:c.price.toString(),description:c.description,category:c.category,stock:c.stock.toString()}),r(c.id),p(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",children:(0,b.jsx)(h,{size:18})}),(0,b.jsx)("button",{onClick:()=>(b=>{if(confirm("Are you sure you want to delete this product?")){let c=a?.storeId;if(!c)return void x("Store not found");fetch(`/api/products?id=${encodeURIComponent(b)}&storeId=${encodeURIComponent(c)}`,{method:"DELETE"}).then(a=>a.json()).then(c=>{if(c&&c.success){let c=k.filter(a=>a.id!==b);if(l(c),a&&a.storeId){let b={...m,products:c};d.StoreDB.update(a.storeId,b),n(b)}z("Product deleted successfully"),setTimeout(()=>z(""),3e3)}else x("Failed to delete product")}).catch(()=>x("Failed to delete product"))}})(c.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:(0,b.jsx)(g.Trash2,{size:18})})]})})]},c.id))})]})})})]})]})})}a.s(["default",()=>k],631)}];

//# sourceMappingURL=_3b3da20a._.js.map